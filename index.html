<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="armada">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>armada</title>
    <style>
    div { 
      text-align: center;
    }
    </style>
    <link href="styles.css" rel="stylesheet" type="text/css">
    <script src="modular.js" type="text/javascript"></script>
    <script type="text/javascript">
    /* Configuration and Initialization */
    window.fuckoffwenetakidcounter = 0;
    ModularJS.config.modulebase = "modules";
    
    /* Module imports */
    Import('libcrypto');
    Import('libsploit')
    Import('libmacho');
        
    /* Common functions */

    function strip(html){
       var doc = new DOMParser().parseFromString(html, 'text/html');
       return doc.body.textContent || "";
    }
    
    //counter to trigger a bug in the handling of URI schemes
    function vm_wenetakid_prot() {

        if(window.fuckoffwenetakidcounter == 3) {
            alert('I swear, leave me alone WEN ETA kid. Next try i will crash your safari to make you fuck off if you do not fuckoff rightnow.');
        }
        
        if(window.fuckoffwenetakidcounter > 3) {
            window.location.href="fuckoff.html";
        }
    }

    //Overwrite document.write to write to our callback element
    document.write = function(x){
        document.getElementById('go').innerHTML+=x;
    };

    //Simple function to write formatted strings to the callback element
    function puts(str) {
        console.log('[WebsploitFramework][Main]: '+strip(str.toString()));
        document.write(str.toString()+"<br>");
    }

    //Simply create an object, as OOP is always better
    var Jailbreakme = {
        initialized: false, 
        callback: function(id){
            return document.getElementById(id);
        }
    };

    //This should always be called first
    Jailbreakme.init = function()
    {

        //loads the required modules for this file and sets the modulebase
        var load_modules = function()
        {
            console.log("Initializing modules...");
            ModularJS.config.modulebase = "modules";
            setTimeout(function(){
                Import('libcrypto');
                Import('libsploit')
                Import('libmacho');
            },0.01); //threaded
        };

        try {
                load_modules();
            }
            catch(exc) //if we end up here, we obviously failed to initialize
            {
                alert("exception occured.\nStack trace: \n"+exc.stack + "\nreason: "+exc.message);
                return;
            }

            this.initialized = true; //We should be initialized now.
			};

    //clears the displayed exploit progress
    Jailbreakme.clearcallback = function() {
        if(!this.callback('status')) return;
        this.callback('status').innerText="";
    };

    //increase counter to trigger a bug in the handling of URI schemes
    Jailbreakme.raise_stupidity = function() {
        if(window.stupidity == window.kStupidity.Stupid) alert('You like pressing some buttons eh? Well I dare you to press it one more time, I\'ll crash your safari. And remember, patience is a virtue!'); //warn the user
        if(window.stupidity == window.kStupidity.WenETABeggar) window.location.href = "denial.html"; //redirect to the bug
        window.stupidity++; //raise the actual stupidity
    };
        
    function clear_callback() {
        document.getElementById('go').innerText=""; //clear the callback element
    }

    
            //__main entry
            Jailbreakme.go = function(sender)
            {
    
                if(!this.initialized) this.init(); //check if we are initialized, otherwise make sure that we are
    
                if(sender) { //if we do not have a sender (e.g.: range element) we are trying to jailbreak directly, that should be avoided, we want the user to interact and make sure he is aware of what he is doing
                    
                    if(sender.value == 1) {
                        
                        var support = document.getElementById('support'); //get a reference to the support element
    
                        if(support != undefined) support.remove(); //in case we have a reference, remove it
    
                        console.log('[WebsploitFramework][Main]: '+'Starting...');
    
                        Jailbreakme.clearcallback(); //clear any previous output or messages on the output element
    
                        var ret = sploit_main(); //try to fire up the device detection->strategy selection->suitable exploit
    
                        if(!ret) this.raise_stupidity(); //if the exploit determination failed, then we raise the stupidity of the user
    
                        sender.value = 0; //reset the sender to it's default value, otherwise a range slider would remain on a slided state.
    
                        return ret; //return the return value of the exploit
    
                    } else { //whether the value is 0 or higher then 1 we will end up here, on a range slider element a slide event making the value 0 means the user cancelled the exploit
    
                        var stdout = document.getElementById('status'); //get a reference to the status element, which is our output element
                        stdout.innerText = "Jailbreak has been canceled."; //update the status notifyinf the user that the exploit's been cancelled
    
                    }
                } else {
                    //this function must be called with a sender thus we do nothing here
                }
    
            };
    
    
            //__load entry
            window.onload = function() {
                try {
                    Jailbreakme.init(); //attempt to initialize the jailbreak
                } catch(exc)
                {
                    alert("Application initialization failed.\nReason:\n"+exc);
                }
            };
    </script>
</head>
<body>
    <script type="text/javascript">
        //Wrapper for the Jailbreakme.go function in a bit more high level. The input element calls this
        var go = function(sender)
        {
            var ret = false;
            try {
                ret = Jailbreakme.go(sender);
            } catch(exc)
            {
                puts("Something went wrong during the exploit<br>Reason:<br>"+exc);
                ret = false;
            }
            return ret;
        };
    </script>
    <div>
        <h1>armada</h1>
        <p id='support'>remote jailbreak tool for iOS 4 - 12.1.1, with some exceptions</p>
        <i style="font-size: 13px !important;">9.3.5 - 9.3.6 (32-bit), <a href="itms-services://?action=download-manifest&url=https://jaimin.xyz/armada/manifest.plist">tap here</a></i>
        <br><i style="font-size: 13px !important;">< 11.4, <a href="jb">tap here</a></i>
        <br><i style="font-size: 13px !important;">12.0 - 12.1.1, <a href="pwn">tap here</a></i>
        <br><i style="font-size: 13px !important;"><a href="denial">don't tap here</a></i>
    </div>
    <main>
        <a class="go" href="#busy" id="go" onclick="go();">jailbreak<noscript>must enable javascript</noscript></a>
    </main>
</body>
</html>
